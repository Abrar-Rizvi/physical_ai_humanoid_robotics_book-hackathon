# Data Model: RAG Chatbot Integration

This document outlines the key entities and their relationships for the RAG chatbot.

## Entities

### Book Content (Chunk)
- **Description**: A segment of the Docusaurus book's textual content, processed for embedding.
- **Attributes**:
    - `id`: Unique identifier for the content chunk.
    - `text`: The raw text of the content chunk.
    - `source_url`: URL to the Docusaurus page where the chunk originated.
    - `chapter_title`: Title of the chapter the chunk belongs to.
    - `position`: Start/end markers within the source (e.g., line numbers, character offsets).

### Embedding
- **Description**: A vector representation of a Book Content Chunk, generated by an embedding model.
- **Attributes**:
    - `id`: Unique identifier for the embedding (often derived from chunk ID).
    - `vector`: The high-dimensional numerical vector representing the chunk.
    - `chunk_id`: Foreign key linking to the associated Book Content Chunk.
    - `model_used`: Identifier for the embedding model used.

### User Query
- **Description**: A natural language question submitted by the user to the chatbot.
- **Attributes**:
    - `id`: Unique identifier for the query.
    - `text`: The raw text of the user's question.
    - `timestamp`: Time when the query was received.
    - `user_session_id`: Identifier for the user's current chat session.
    - `context_text_selected`: Optional, user-selected text providing additional context.

### Chatbot Response
- **Description**: The answer generated by the RAG pipeline in response to a User Query.
- **Attributes**:
    - `id`: Unique identifier for the response.
    - `query_id`: Foreign key linking to the associated User Query.
    - `text`: The generated textual answer.
    - `timestamp`: Time when the response was generated.
    - `retrieved_chunk_ids`: List of `chunk_id`s that were used to ground the response.
    - `llm_model_used`: Identifier for the LLM used to generate the response.
    - `confidence_score`: (Optional) A score indicating the chatbot's confidence in the answer.

## Relationships

- **Book Content** has **Embeddings** (one-to-many: one content chunk can have multiple embeddings if different models are used, or one-to-one if a single model is assumed).
- **User Query** leads to **Chatbot Response** (one-to-one).
- **Chatbot Response** is grounded in **Book Content** (many-to-many: a response can use multiple chunks, and a chunk can be used in multiple responses).
